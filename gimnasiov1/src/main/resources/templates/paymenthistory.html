<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Historial de Pagos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f5f6f7; }
    .card-custom { max-width: 1100px; width: 100%; border-radius: 12px; }
    .table-hover tbody tr:hover { background: #fff8e6; }
    .badge-status-ACTIVA { background: #198754; }
    .badge-status-VENCIDA { background: #dc3545; }
    .badge-method-cash { background: #6c757d; }
    .badge-method-card { background: #0d6efd; }
    .badge-method-transfer { background: #20c997; }
    .badge-method-other { background: #fd7e14; }
  </style>
</head>
<body>
<div class="container my-5">
  <div class="card card-custom shadow-sm p-4">
    <h3 class="mb-3">Mi Historial de Suscripciones y Pagos</h3>
    <p class="text-muted">Consulta tus suscripciones activas y transacciones pasadas.</p>

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" id="historyTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="suscripciones-tab" data-bs-toggle="tab" data-bs-target="#suscripciones" type="button" role="tab">Suscripciones</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pagos-tab" data-bs-toggle="tab" data-bs-target="#pagos" type="button" role="tab">Historial de Pagos</button>
      </li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content mt-4">
      <!-- Suscripciones -->
      <div class="tab-pane fade show active" id="suscripciones" role="tabpanel">
        <div class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
            <tr>
              <th>#</th>
              <th>Periodo</th>
              <th>Estado</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="suscripcion, iter : ${suscripciones}">
              <td th:text="${iter.count}">1</td>
              <td>
                <span th:text="${#temporals.format(suscripcion.periodStart, 'dd/MM/yyyy')}"></span> -
                <span th:text="${#temporals.format(suscripcion.periodEnd, 'dd/MM/yyyy')}"></span>
              </td>
              <td>

                                    <!--<span th:classappend="'badge badge-status-' + ${suscripcion.estado}"
                                          class="badge rounded-pill"
                                          th:text="${suscripcion.estado}">ACTIVA</span>-->
              </td>
            </tr>
            <tr th:if="${#lists.isEmpty(suscripciones)}">
              <td colspan="3" class="text-center text-muted">No tienes suscripciones registradas.</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pagos -->
      <div class="tab-pane fade" id="pagos" role="tabpanel">
        <div class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
            <tr>
              <th>#</th>
              <th>Fecha de Pago</th>
              <th>Monto</th>
              <th>MÃ©todo</th>
              <th>Periodo Cubierto</th>
              <th>Acciones</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="pago, iter : ${historialPagos}">
              <td th:text="${iter.count}">1</td>
              <td th:text="${#temporals.format(pago.paidAt, 'dd/MM/yyyy HH:mm')}">28/09/2025</td>
              <td>
                <span th:text="${pago.amount}">50</span>
                <span th:text="${pago.currency}">PEN</span>
              </td>
              <td>
                                    <span th:classappend="'badge badge-method-' + ${pago.method}"
                                          class="badge rounded-pill"
                                          th:text="${pago.method}">card</span>
              </td>
              <td>
                <span th:text="${#temporals.format(pago.periodStart, 'dd/MM/yyyy')}"></span> -
                <span th:text="${#temporals.format(pago.periodEnd, 'dd/MM/yyyy')}"></span>
              </td>
              <td>
                <a th:href="@{'/pagos/recibo/' + ${pago.id}}" class="btn btn-sm btn-primary">
                  Ver Recibo
                </a>
              </td>
            </tr>
            <tr th:if="${#lists.isEmpty(historialPagos)}">
              <td colspan="6" class="text-center text-muted">No se encontraron pagos registrados.</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
